#羚羊云Web API使用须知
## 1 羚羊云http服务地址

* 正式：http://api.topvdn.com

## 2 相关名词
- **`应用服务器`**
用户开发的服务端应用程序，为客户端程序提供后台数据、后台业务处理等服务。
- **`应用客户端`**
用户开发的客户端应用程序，如手机app、PC桌面应用、嵌入在智能硬件设备中的应用程序等等。
- **`设备`**
接入到羚羊云的程序化设备，承载着用户开发的客户端应用程序，从视频流向的角度不同可分为推流设备和拉流设备。
- **`设备token`**
本方设备所携带的token称为设备token。
- **`访问token`**
对端设备的token称为访问token。
- **`循环式录像`**
推流设备在推送媒体流到羚羊云的过程中，不间断循环将音视频流存储在羚羊云，存储期限可配置为7天、30天等，若超过存储期限，将会覆盖最旧的存储数据。录像的存在既有以时间轴形式体现，也有以录像文件列表形式体现。
- **`事件式录像`**
推流设备在推送媒体流到羚羊云的过程中，只在有外部产生某种事件时，才会触发将音视频数据存储在羚羊云，存储体现的形式为录像文件列表。

## 3 请求相关

请求数据：

* GET：请求使用标准的 HTTP 请求。
* POST：
    *  请求体：json 数据
    *  请求首部：`Content-Type: application/json; charset=utf-8` 。

请求返回：

* 返回数据： 如果返回的 HTTP 状态码为 `200` 则返回 `json` 数据，非 `200` 的状态码则为请求错误，请根据接口错误码判断。

## 4 状态码

接口的请求状态可以通过 HTTP 的状态码判断，下面列出一些通用的状态码：

| 错误码  | 描述                     |
| ---- | ---------------------- |
| 200  | 请求成功，返回正确的数据           |
| 400  | 参数错误，可能缺少参数或者类型不正确     |
| 401  | token 或者 app_key 验证不通过 |
| 500  | 系统内部错误                 |

## 5 权限验证

应用服务器发送的请求必须设置以下验证相关的请求首部：

* `X-APP-ID` : 请求的 APP ID ，4 个字符，羚羊云分配
* `X-APP-Key`：请求的 APP 标识 key， 32 个字符，羚羊云分配，请不要把 key 存放在不可控的设备段上，如果泄露，可以申请重新分配

应用客户端发送的请求必须验证token，需要在请求体中携带：

* `X-Client-Token`: client 设备 token，即`本方`设备的token。
* `X-Access-Token`: 设备访问 token，即`对端`设备的token。

**注意：验证 token 的提交方式，支持在请求首部及作为 query param 的方式**

| 类型         | 请求首部             | query param  |
| ---------- | ---------------- | ------------ |
| 设备 token   | `X-Client-Token` | client_token |
| 设备访问 token | `X-Access-Token` | access_token |

## 6 调试信息

为了方便调试，接口的每次请求都会返回这个请求的唯一标识，这个请求标识可以在响应头 header 的 `X-Request-ID` 得到。

另外考虑到一些情况下不太方便查看响应头，这个请求标识同样也加入到了返回的 json 数据中，字段名为 `request_id`。

如果请求出问题，可以提交这个请求标识给羚羊云去查看相关的情况。

## 7 接口类型

* 管理接口：提供给`应用服务器`的接口，只验证 app id 及 app key；
* 设备接口：提供给`设备(应用客户端)`的接口，需要验证设备 token；
